!function(n){tinymce.create("tinymce.plugins.VlsGfButtons",{init:function(n,l){n.addButton("vls_gf_album",{title:vlsGfTinymceL10n.btnInsertGFAlbum,cmd:"albumShortcode"}),n.addCommand("albumShortcode",this.showAlbumSelectionDialog,{self:this,editor:n})},getInfo:function(){return{longname:"Gallery Factory Buttons",author:"Vilyon",authorurl:"http://galleryfactory.vilyon.net",infourl:"http://galleryfactory.vilyon.net",version:"1.1"}},showAlbumSelectionDialog:function(){var l=this.self,t=this.editor;t.windowManager.open({id:"vls-gf-album-shortcode-dialog",html:'<div class="vls-gf-loading-overlay"><span></span></div>',width:500,height:.7*(n(window).height()-36-50),title:vlsGfTinymceL10n.strSelectAlbum,buttons:[{text:vlsGfTinymceL10n.btnCancel,onclick:"close"}]}),n.get(ajaxurl,{action:"vls_gf_view_tinymce_album_selection_dialog"},function(n){console.log("modal loaded"),l.initModalContent(n,t)},"html")},initModalContent:function(l,t){console.log("modal loaded 2");var o=n("#vls-gf-album-shortcode-dialog-body");o.empty().append(l),o.find("li.vls-gf-folder").on("click",function(){var l=n(this);return l.hasClass("vls-gf-opened")?l.children("ul").slideUp(300):l.children("ul").slideDown(300),n(this).toggleClass("vls-gf-opened"),!1}),o.find("li.vls-gf-album").on("click",function(){var l=n(this).data("id");return t.insertContent('[vls_gf_album id="'+l+'"]'),t.windowManager.close(),!1})}}),tinymce.PluginManager.add("vls_gf_buttons",tinymce.plugins.VlsGfButtons)}(jQuery);